# Javaåç«¯ä¸UniAppå‰ç«¯é›†æˆè¯´æ˜

## âœ… ä¸ºä»€ä¹ˆè½¬æ¢æˆJavaæ›´æ–¹ä¾¿ï¼Ÿ

**ç­”æ¡ˆï¼šæ˜¯çš„ï¼** è½¬æ¢æˆJavaåï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°é›†æˆåˆ°ä½ çš„APPä¸­ï¼ŒåŸå› å¦‚ä¸‹ï¼š

### 1. **ç»Ÿä¸€æŠ€æœ¯æ ˆ**
- å¦‚æœä½ çš„åç«¯å·²ç»ä½¿ç”¨Javaï¼ˆSpring Bootï¼‰ï¼Œé‚£ä¹ˆAIèŠå¤©åŠŸèƒ½å¯ä»¥ç›´æ¥é›†æˆåˆ°ç°æœ‰åç«¯
- ä¸éœ€è¦å•ç‹¬ç»´æŠ¤PythonæœåŠ¡

### 2. **æ›´å¥½çš„æ€§èƒ½**
- Javaåç«¯å¯ä»¥æ›´å¥½åœ°å¤„ç†å¹¶å‘è¯·æ±‚
- ä¸ç°æœ‰Javaåç«¯å…±äº«èµ„æºï¼ˆæ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼‰

### 3. **éƒ¨ç½²ç®€å•**
- å¯ä»¥æ‰“åŒ…æˆå•ä¸ªJARæ–‡ä»¶ï¼Œéƒ¨ç½²æ–¹ä¾¿
- ä¸ç°æœ‰JavaæœåŠ¡ä¸€èµ·éƒ¨ç½²ï¼Œæ— éœ€é¢å¤–ç¯å¢ƒ

## ğŸ“¦ é›†æˆæ­¥éª¤

### æ–¹å¼ä¸€ï¼šä½œä¸ºç‹¬ç«‹æœåŠ¡è¿è¡Œï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

1. **å¯åŠ¨Javaåç«¯**
```bash
cd GeneAI-Java
mvn spring-boot:run
```

2. **é…ç½®å‰ç«¯APIåœ°å€**
åœ¨ `src/utils/request.js` ä¸­ï¼š
```javascript
const BASE_URL = 'http://localhost:3000'; // Javaåç«¯åœ°å€
```

3. **å‰ç«¯ç›´æ¥è°ƒç”¨**
å‰ç«¯å·²ç»æ›´æ–°äº† `src/api/aiChat.js`ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š
```javascript
import { sendMessage } from '@/api/aiChat.js';

// å‘é€æ¶ˆæ¯
const result = await sendMessage('session_123', 'æˆ‘ä»Šå¤©æ„Ÿè§‰å¾ˆç„¦è™‘');
console.log(result.data.aiResponse); // AIå›å¤
console.log(result.data.analysis);   // å¿ƒç†åˆ†æç»“æœ
```

### æ–¹å¼äºŒï¼šé›†æˆåˆ°ç°æœ‰Javaåç«¯

å¦‚æœä½ çš„é¡¹ç›®å·²ç»æœ‰Javaåç«¯ï¼Œå¯ä»¥ï¼š

1. **å¤åˆ¶ä»£ç åˆ°ç°æœ‰é¡¹ç›®**
   - å¤åˆ¶ `service` å’Œ `model` åŒ…åˆ°ä½ çš„é¡¹ç›®
   - å¤åˆ¶ `controller` ä¸­çš„æ¥å£åˆ°ä½ çš„æ§åˆ¶å™¨

2. **æ·»åŠ ä¾èµ–**
   åœ¨ä½ çš„ `pom.xml` ä¸­æ·»åŠ ï¼š
   ```xml
   <dependency>
       <groupId>com.theokanning.openai-gpt3-java</groupId>
       <artifactId>service</artifactId>
       <version>0.18.2</version>
   </dependency>
   ```

3. **é…ç½®API Key**
   åœ¨ `application.yml` ä¸­ï¼š
   ```yaml
   openai:
     api:
       key: ${OPENAI_API_KEY}
   ```

## ğŸ”Œ APIæ¥å£è¯´æ˜

### 1. å‘é€æ¶ˆæ¯ï¼ˆåŒ…å«å¿ƒç†åˆ†æï¼‰

**è¯·æ±‚ï¼š**
```http
POST /api/ai/chat/messages
Content-Type: application/json

{
  "sessionId": "session_123",  // å¯é€‰ï¼Œä¸ä¼ åˆ™è‡ªåŠ¨åˆ›å»º
  "message": "æˆ‘ä»Šå¤©æ„Ÿè§‰å¾ˆç„¦è™‘"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "å‘é€æˆåŠŸ",
  "data": {
    "sessionId": "session_123",
    "userMessage": "æˆ‘ä»Šå¤©æ„Ÿè§‰å¾ˆç„¦è™‘",
    "aiResponse": "å°æš–çš„æ¸©æš–å›å¤...",
    "analysis": {
      "emotionalState": "ç„¦è™‘",
      "riskLevel": "ä¸­",
      "psychologicalIssues": ["ç„¦è™‘æƒ…ç»ª"],
      "keyConcerns": ["æƒ…ç»ªç®¡ç†"],
      "suggestedApproach": "æä¾›æƒ…ç»ªç–å¯¼",
      "supportiveKeywords": ["ç†è§£", "é™ªä¼´", "æ”¯æŒ"]
    }
  }
}
```

### 2. è·å–ä¼šè¯å†å²

**è¯·æ±‚ï¼š**
```http
GET /api/ai/chat/sessions/{sessionId}/messages
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "messages": [
      {"role": "user", "content": "..."},
      {"role": "assistant", "content": "..."}
    ],
    "analyses": [...]
  }
}
```

### 3. ä¿å­˜ç”¨æˆ·ä¿¡æ¯

**è¯·æ±‚ï¼š**
```http
POST /api/ai/chat/user-info
Content-Type: application/json

{
  "name": "å¼ ä¸‰",
  "age": 25,
  "visionType": "å…¨ç›²",
  "currentMood": 5,
  "recentConcern": "æœ€è¿‘å·¥ä½œå‹åŠ›å¤§",
  "supportNeeds": ["å‹åŠ›ç¼“è§£", "æƒ…æ„Ÿé™ªä¼´"]
}
```

## ğŸ¨ å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```vue
<template>
  <view class="chat-page">
    <scroll-view class="messages" scroll-y>
      <view v-for="(msg, index) in messages" :key="index" 
            :class="['message', msg.role]">
        <text>{{ msg.content }}</text>
      </view>
    </scroll-view>
    
    <view class="input-area">
      <input v-model="inputText" placeholder="å‘Šè¯‰æˆ‘ä½ çš„æƒ³æ³•..." />
      <button @click="sendMsg">å‘é€</button>
    </view>
  </view>
</template>

<script>
import { sendMessage } from '@/api/aiChat.js';

export default {
  data() {
    return {
      messages: [],
      inputText: '',
      sessionId: null,
    };
  },
  methods: {
    async sendMsg() {
      if (!this.inputText.trim()) return;
      
      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°ç•Œé¢
      this.messages.push({
        role: 'user',
        content: this.inputText,
      });
      
      const userMsg = this.inputText;
      this.inputText = '';
      
      try {
        // è°ƒç”¨API
        const result = await sendMessage(this.sessionId, userMsg);
        
        if (result.code === 200) {
          // ä¿å­˜sessionId
          this.sessionId = result.data.sessionId;
          
          // æ·»åŠ AIå›å¤
          this.messages.push({
            role: 'assistant',
            content: result.data.aiResponse,
          });
          
          // å¯é€‰ï¼šæ˜¾ç¤ºå¿ƒç†åˆ†æç»“æœ
          console.log('å¿ƒç†åˆ†æ:', result.data.analysis);
        }
      } catch (error) {
        uni.showToast({
          title: 'å‘é€å¤±è´¥',
          icon: 'none',
        });
      }
    },
  },
};
</script>
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆåœ¨Javaé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š
```
OPENAI_API_KEY=your_api_key_here
```

æˆ–è€…åœ¨ `application.yml` ä¸­ç›´æ¥é…ç½®ï¼š
```yaml
openai:
  api:
    key: your_api_key_here
    base-url: https://api.chatanywhere.tech
```

### ç«¯å£é…ç½®

é»˜è®¤ç«¯å£æ˜¯ `3000`ï¼Œå¯ä»¥åœ¨ `application.yml` ä¸­ä¿®æ”¹ï¼š
```yaml
server:
  port: 3000
```

## ğŸš€ éƒ¨ç½²å»ºè®®

1. **å¼€å‘ç¯å¢ƒ**ï¼šç›´æ¥è¿è¡Œ `mvn spring-boot:run`
2. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   - æ‰“åŒ…ï¼š`mvn clean package`
   - è¿è¡Œï¼š`java -jar target/geneai-java-1.0.0.jar`
   - å»ºè®®ä½¿ç”¨è¿›ç¨‹ç®¡ç†å·¥å…·ï¼ˆå¦‚PM2ã€systemdï¼‰

3. **ä¼šè¯å­˜å‚¨**ï¼š
   - å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼ˆé€‚åˆå¼€å‘ï¼‰
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Redisæˆ–æ•°æ®åº“

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **API Keyå®‰å…¨**ï¼šä¸è¦å°†API Keyæäº¤åˆ°ä»£ç ä»“åº“
2. **è·¨åŸŸé…ç½®**ï¼šå·²é…ç½® `@CrossOrigin`ï¼Œå…è®¸å‰ç«¯è·¨åŸŸè®¿é—®
3. **é”™è¯¯å¤„ç†**ï¼šç”Ÿäº§ç¯å¢ƒéœ€è¦æ›´å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—
4. **ä¼šè¯ç®¡ç†**ï¼šå½“å‰æ˜¯å†…å­˜å­˜å‚¨ï¼Œé‡å¯æœåŠ¡ä¼šä¸¢å¤±ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦æŒä¹…åŒ–

## ğŸ¯ æ€»ç»“

è½¬æ¢æˆJavaåï¼š
- âœ… å¯ä»¥ç›´æ¥é›†æˆåˆ°ç°æœ‰Javaåç«¯
- âœ… å‰ç«¯é€šè¿‡HTTP APIè°ƒç”¨ï¼Œä¸è¯­è¨€æ— å…³
- âœ… éƒ¨ç½²å’Œç»´æŠ¤æ›´æ–¹ä¾¿
- âœ… æ€§èƒ½æ›´å¥½ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ

å‰ç«¯ï¼ˆUniApp/Vueï¼‰å’Œåç«¯ï¼ˆJavaï¼‰é€šè¿‡RESTful APIé€šä¿¡ï¼Œå®Œå…¨è§£è€¦ï¼Œéå¸¸æ–¹ä¾¿ï¼




"use strict";const o=require("../../common/vendor.js"),c={data(){return{role:"blind",cityList:["北京","上海","广州","深圳","杭州","南京","成都","武汉","西安","重庆","天津","苏州","长沙","郑州","济南","青岛","大连","厦门","福州","合肥","石家庄","太原","沈阳","长春","哈尔滨","南昌","南宁","海口","昆明","贵阳","其他城市"],formData:{age:"",height:"",weight:"",visionType:"half",experience:"",runningArea:"",locationDetail:"",remarks:"",volunteerExperience:""}}},computed:{cityIndex(){const i=this.cityList.indexOf(this.formData.runningArea);return i>=0?i:0}},onLoad(){try{const i=o.index.getStorageSync("userRole");i&&(this.role=i)}catch{}this.loadProfile()},methods:{loadProfile(){try{const i=o.index.getStorageSync("userProfile");if(i){const n=JSON.parse(i);this.formData={...this.formData,...n}}}catch(i){console.error("加载用户信息失败:",i)}},onCityChange(i){const n=i.detail.value;this.formData.runningArea=this.cityList[n],this.formData.locationDetail=""},chooseLocation(){o.index.chooseLocation({success:i=>{const n=i.address||"",s=i.name||"";let a="";for(let e of this.cityList)if(n.includes(e)||s.includes(e)){a=e;break}if(a)this.formData.runningArea=a;else{const e=n.match(/([\u4e00-\u9fa5]+(?:市|省))/);e?this.formData.runningArea=e[1].replace("省","").replace("市",""):this.formData.runningArea="其他城市"}this.formData.locationDetail=`${s} - ${n}`,o.index.showToast({title:"位置选择成功",icon:"success"})},fail:i=>{console.error("选择位置失败:",i),i.errMsg&&i.errMsg.includes("not support")?o.index.showToast({title:"当前平台不支持地图选择",icon:"none"}):o.index.showToast({title:"选择位置失败，请重试",icon:"none"})}})},saveProfile(){if(!this.formData.age||!this.formData.height||!this.formData.weight){o.index.showToast({title:"请填写年龄、身高、体重",icon:"none"});return}if(!this.formData.experience||this.formData.experience.trim()===""){o.index.showToast({title:"请填写跑步经验",icon:"none"});return}try{o.index.setStorageSync("userProfile",JSON.stringify(this.formData)),o.index.showToast({title:"保存成功",icon:"success"}),setTimeout(()=>{o.index.navigateBack()},1500)}catch(i){console.error("保存失败:",i),o.index.showToast({title:"保存失败，请重试",icon:"none"})}},goBack(){o.index.navigateBack()}}};function l(i,n,s,a,e,r){return o.e({a:o.o((...t)=>r.goBack&&r.goBack(...t)),b:e.formData.age,c:o.o(t=>e.formData.age=t.detail.value),d:e.formData.height,e:o.o(t=>e.formData.height=t.detail.value),f:e.formData.weight,g:o.o(t=>e.formData.weight=t.detail.value),h:e.role==="blind"},e.role==="blind"?o.e({i:e.formData.visionType==="half"},e.formData.visionType==="half"?{}:{},{j:e.formData.visionType==="half"?1:"",k:o.o(t=>e.formData.visionType="half"),l:e.formData.visionType==="full"},e.formData.visionType==="full"?{}:{},{m:e.formData.visionType==="full"?1:"",n:o.o(t=>e.formData.visionType="full")}):{},{o:e.role==="volunteer"},e.role==="volunteer"?{p:e.formData.volunteerExperience,q:o.o(t=>e.formData.volunteerExperience=t.detail.value)}:{},{r:e.formData.experience,s:o.o(t=>e.formData.experience=t.detail.value),t:o.t(e.formData.runningArea||"请选择城市"),v:o.n(e.formData.runningArea?"picker-text":"picker-placeholder"),w:e.cityList,x:r.cityIndex,y:o.o((...t)=>r.onCityChange&&r.onCityChange(...t)),z:o.o((...t)=>r.chooseLocation&&r.chooseLocation(...t)),A:e.formData.locationDetail},e.formData.locationDetail?{B:o.t(e.formData.locationDetail)}:{},{C:e.formData.remarks,D:o.o(t=>e.formData.remarks=t.detail.value),E:o.o((...t)=>r.saveProfile&&r.saveProfile(...t))})}const f=o._export_sfc(c,[["render",l],["__scopeId","data-v-e58bb59b"]]);wx.createPage(f);
